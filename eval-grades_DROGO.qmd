---
title: "eval-grades_DROGO"
author: "Louis DROGO"
format: html
editor: visual
---


```{r}
#| message: false
#| echo: false

library(ggplot2)
library(dplyr)
library(tidyr)
library(lubridate)
library(vroom)
library(here)

here::i_am("eval-grades.Rproj")
```


# I - Introduction

## 1. Study Organisation

### Question 1

```{r}
courses <- vroom("Data/courses.csv",delim = ",", show_col_types = FALSE)
```

### Question 2

```{r}
#| echo: false
courses |>
  arrange(course)|>
  rename("course name"=course,
         "identifier"=course_id,
         "number of exam"=nb_grades)|>
  knitr::kable()
```


## 2. Students

### Question 3

```{r}
#| echo: false
students <- vroom("Data/students.csv",delim = ",",show_col_types = FALSE)
students$sex <- as.factor(students$sex)
sapply(students, class)
```
## 3. Graddes

### Question 4

```{r}
grades <- vroom("Data/grades.csv",delim = "|",na=c("$"),show_col_types = FALSE)
```


# II - Population

### Question 5

```{r}
students |>
  group_by(group)|>
  summarise(count=n())|>
  ggplot(aes(x=group,y=count))+
  geom_col()+
  labs(title = "Number of Students per Group",x = "Group Number",y = "Number of Students")
```


### Question 6

```{r}
students |>
  group_by(group,sex)|>
  summarise(count=n(),.groups = "drop")|>
  ggplot(aes(x=group,y=count,fill = sex))+
  geom_col()+
  labs(title = "Gender balance per Group",x = "Group Number",y = "Number of Students")
```


### Question 7

```{r}
students <- students |>
  mutate(age=time_length(today()- birth_date, unit="year"))

students$age <- round(students$age) # I round every age to the closest integer

students |>
  ggplot(aes(x=age))+
  geom_histogram(binwidth = 1, color = "white")+
  labs(title = "Distribution of Student Age",x = "Age (Years)",y = "Density / Count")+
  theme_minimal()
```


### Question 8

```{r}
students |>
  group_by(group)|>
  summarise(median=round(median(age)))|>
  knitr::kable()
```

### Question 9

```{r}
students|>
  group_by(group)|>
  slice_max(order_by = age, n = 1, with_ties = FALSE)|>
  select(id, sex, age, group)|>
  arrange(desc(age))|>
  knitr::kable()
```


